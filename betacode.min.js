/**
 * betacode.js (https://github.com/exchange-projekt/betacode.js)
 * A Javascript converter from and to pre-unicode Greek notation
 * © 2014, Peggy Lucke & Thomas Efer
 */
(function(e){"use strict";function t(e){return typeof unorm!="undefined"?unorm.nfd(e):e}function n(e){return typeof unorm!="undefined"?unorm.nfc(e):e}function r(e){output=unescape(e.replace(/\]/g,"").replace(/\[U\+/g,"%u"));return output}function s(e){var t="";for(i in e.split("")){t+="[U+"+("0000"+e.charCodeAt(i).toString(16)).substr(-4)+"]"}return t}function o(e){output=n(e);return output}function u(){}function a(e,t,n){var r=e[0];if(e[1]){r=r.toUpperCase();e[1]=false}if(n){if(e[2]){r+=t[0];e[2]=false}if(e[3]){if(/[αερυηιοωτλθπ]/i.test(r)){r+=t[1]}else{r+=t[2]}e[3]=false}if(e[4]){if(/[αερυηιοωτλθπ]/i.test(r)){r+=t[3]}else{r+=t[4]}e[4]=false}if(e[5]){if(/[αερυηιοωτλθπ]/i.test(r)){r+=t[5]}else{r+=t[6]}e[5]=false}if(e[6]){r+=t[7];e[6]=false}if(e[7]){r+=t[8];e[7]=false}if(e[8]){r+=t[9];e[8]=false}if(e[9]){if(/[αυι]/i.test(r)){r+=t[10]}else{r+=t[12]}e[9]=false}if(e[10]){r+=t[11];e[10]=false}}e[0]=r;return e}u.prototype.version="0.9";u.prototype.preprocess=function(e){this.input=e;var n=this.akut;var r=this.gravis;var i=this.splenis;var s=this.spasper;var e=t(e);var o=/[\u00B4\u02B9\u02CA\u0374\u0384\u1FFD\u0301]/ig;var u=/[\u1FEF\u0060\uFF40\u02F4\u055D\u2035\u0300]/ig;var a=/[\u1fbd\u2019\u0313\u02bc\u1fbf]/ig;var f=/[\u1FFE\u0314\u02bb\u02bd]/ig;var l=e.replace(o,n);l=l.replace(a,i);l=l.replace(u,r);l=l.replace(f,s);l=t(l);return l};e.Beta=e.β=u;u.prototype.input="";u.prototype.akut="́";u.prototype.akut2="´";u.prototype.gravis="̀";u.prototype.splenis="̓";u.prototype.splenis2="᾽";u.prototype.spasper="̔";u.prototype.spasper2="῾";u.prototype.iotasubscriptum="ͅ";u.prototype.zirkumflex="͂";u.prototype.trema="̈";u.prototype.macron="̄";u.prototype.breve="̆";u.prototype.tagFault=false;u.prototype.seeFault=true;u.prototype.seeDiacritics=true;u.prototype.betabreve="'";u.prototype.betamacron="&";u.prototype.betacodeWithoutDiacritics=function(e){var t=new u;t.seeDiacritics=false;t.tagFault=this.tagFault;t.seeFault=this.seeFault;t.betabreve=this.betabreve;t.betamacron=this.betamacron;t.akut=this.akut;t.akut2=this.akut2;t.gravis=this.gravis;t.splenis=this.splenis;t.splenis2=this.splenis2;t.spasper=this.spasper;t.spasper2=this.spasper2;t.iotasubscriptum=this.iotasubscriptum;t.zirkumflex=this.zirkumflex;t.trema=this.trema;t.macron=this.macron;t.breve=this.breve;var n=t.betacodeToGreek(e)[0];return t.greekToBetacode(n)};u.prototype.greekWithoutDiacritics=function(e){var t=new u;t.seeDiacritics=false;t.tagFault=this.tagFault;t.seeFault=this.seeFault;t.betabreve=this.betabreve;t.betamacron=this.betamacron;t.akut=this.akut;t.akut2=this.akut2;t.gravis=this.gravis;t.splenis=this.splenis;t.splenis2=this.splenis2;t.spasper=this.spasper;t.spasper2=this.spasper2;t.iotasubscriptum=this.iotasubscriptum;t.zirkumflex=this.zirkumflex;t.trema=this.trema;t.macron=this.macron;t.breve=this.breve;var n=t.greekToBetacode(e)[0];return t.betacodeToGreek(n)};u.prototype.convert=function(e){var t=new u;t.seeDiacritics=this.seeDiacritics;t.tagFault=this.tagFault;t.seeFault=this.seeFault;t.betabreve=this.betabreve;t.betamacron=this.betamacron;t.akut=this.akut;t.akut2=this.akut2;t.gravis=this.gravis;t.splenis=this.splenis;t.splenis2=this.splenis2;t.spasper=this.spasper;t.spasper2=this.spasper2;t.iotasubscriptum=this.iotasubscriptum;t.zirkumflex=this.zirkumflex;t.trema=this.trema;t.macron=this.macron;t.beve=this.breve;e+=" ";var n=new Array;if(e.length>20){if(t.betacodeToGreek(e.slice(0,19))[1]<t.greekToBetacode(e.slice(0,19))[1]){if(t.betacodeToGreek(e.slice(0,19))[1]<t.spionicToGreek(e.slice(0,19))[1]){n=t.betacodeToGreek(e)}else{n=t.spionicToGreek(e)}}else{n=t.greekToBetacode(e)}}else{if(t.betacodeToGreek(e)[1]<t.greekToBetacode(e)[1]){if(t.betacodeToGreek(e.slice(0,19))[1]<t.spionicToGreek(e.slice(0,19))[1]){n=t.betacodeToGreek(e)}else{n=t.spionicToGreek(e)}}else{n=t.greekToBetacode(e)}}n[0]=n[0].substr(0,n[0].length-1);return n};u.prototype.betacodeToGreek=function(e){this.input=e;var t=this.tagFault;var r=false;var i=this.seeFault;var s=this.seeDiacritics;var o="";var u={a:"α",b:"β",g:"γ",d:"δ",e:"ε",z:"ζ",h:"η",q:"θ",i:"ι",k:"κ",l:"λ",m:"μ",n:"ν",c:"ξ",o:"ο",p:"π",r:"ρ",j:"ς",s:"σ",t:"τ",u:"υ",f:"φ",x:"χ",y:"ψ",w:"ω",v:"ϝ"};var f=0;var l="";var c=new Array("",false,false,false,false,false,false,false,false,false,false);var h="*";var p="/";var d="\\";var v="(";var m=")";var g="|";var y="=";var b="+";var w=this.betamacron;var E="_";var S=this.betabreve;var x=new Array(this.trema,this.spasper,this.spasper2,this.splenis,this.splenis2,this.akut,this.akut2,this.gravis,this.zirkumflex,this.macron,this.breve,this.iotasubscriptum,this.betabreve);for(var T=0;T<e.length;T++){var N=e.charAt(T);if(u[N.toLowerCase()]){if(c[0].length===0){if(N===N.toLowerCase()){if(N=="s"){var C=e.charAt(T+1);if(C=="1"){c[0]="σ";T++;r=false;continue}if(C=="2"){c[0]="ς";T++;r=false;continue}if(C=="3"){c[0]="ϲ";T++;r=false;continue}if(/[\s,\.\-\?;:\']/.test(C)||C==S){c[0]="ς";r=false;continue}}c[0]=u[N];r=false}else{if(N=="S"){var C=e.charAt(T+1);if(C=="1"){c[0]="σ";T++;r=false;continue}if(C=="2"){c[0]="ς";T++;r=false;continue}if(C=="3"){c[0]="ϲ";T++;r=false;continue}}c[0]=u[N.toLowerCase()].toUpperCase();r=false}}else{c=a(c,x,s);l=l+c[0];if(N===N.toLowerCase()){if(N=="s"){var C=e.charAt(T+1);if(C=="1"){c[0]=u[N];T++;r=false;continue}if(C=="2"){c[0]="ς";T++;r=false;continue}if(C=="3"){c[0]="ϲ";T++;r=false;continue}if(/[\s,\.\-\?\';:]/.test(C)){c[0]="ς";r=false;continue}}c[0]=u[N];r=false}else{if(N=="S"){var C=e.charAt(T+1);if(C=="1"){c[0]="σ";T++;r=false;continue}if(C=="2"){c[0]="ς";T++;r=false;continue}if(C=="3"){c[0]="ϲ";T++;r=false;continue}}c[0]=u[N.toLowerCase()].toUpperCase();r=false}}r=false;continue}if(N==h){if(c[0].length===0){c[1]=true}else{c=a(c,x,s);l=l+c[0];c[1]=true;c[0]=""}r=false;continue}if(N==p){c[5]=true;r=false;continue}if(N==d){c[6]=true;r=false;continue}if(N==v){c[3]=true;r=false;continue}if(N==m){c[4]=true;r=false;continue}if(N==g){c[10]=true;r=false;continue}if(N==y){c[7]=true;r=false;continue}if(N==b){c[2]=true;r=false;continue}if(N==w||N==E){c[8]=true;r=false;continue}if(N==S){c[9]=true;r=false;continue}if(N=="%"){if(e.charAt(T+1)=="2"){if(e.charAt(T+2)=="6"){c[8]=true;T=T+2}if(e.charAt(T+2)=="7"){c[9]=true;T=T+2}}r=false;continue}if(N=="#"){var C=e.charAt(T+1);if(C=="2"){if(e.charAt(T+2)=="2"){if(c[0].length===0){l=l+"͵";T=T+2}else{c=a(c,x,s);l=l+c[0]+"͵";c[0]="";T=T+2}r=false;continue}if(c[0].length===0){c[0]="ϛ";T++;r=false;continue}else{c=a(c,x,s);l=l+c[0];c[0]="ϛ";T++;r=false;continue}}if(C=="3"){if(c[0].length===0){c[0]="ϟ";T++;r=false;continue}else{c=a(c,x,s);l=l+c[0];c[0]="ϟ";T++;r=false;continue}}if(C=="4"){if(c[0].length===0){c[0]="ϡ";T++;r=false;continue}else{c=a(c,x,s);l=l+c[0];c[0]="ϡ";T++;r=false;continue}}}c=a(c,x,s);l=l+c[0];c[0]="";if(N==";"||N==":"){l=l+"·";r=false;continue}if(N=="?"){l=l+";";r=false;continue}if(N=="#"){l=l+"ʹ";r=false;continue}if(/[\s,\.\-\?;:\']/.test(N)){l=l+N;r=false;continue}if(i){if(t){if(r){l=l.slice(0,l.lastIndexOf("</fault>",0)-7);l=l+N+"</fault>"}else{l=l+"<fault>"+N+"</fault>";r=true}}else{l=l+N}}f++}if(c[0].length!==0){c=a(c,x,s);l=l+c[0]}l=n(l);var k=new Array(l,f);return k};u.prototype.spionicToGreek=function(e){this.input=e;var t=this.seeDiacritics;var r=this.tagFault;var i=false;var s=this.seeFault;var o="";var u={a:"α",b:"β",g:"γ",d:"δ",e:"ε",z:"ζ",h:"η",q:"θ",i:"ι",k:"κ",l:"λ",m:"μ",n:"ν",c:"ξ",o:"ο",p:"π",r:"ρ",j:"ς",s:"σ",t:"τ",u:"υ",f:"φ",x:"χ",y:"ψ",w:"ω",v:"ϝ"};var f=0;var l="";var c=new Array("",false,false,false,false,false,false,false,false,false,false);var h="/";var p="&";var d="\\";var v="_";var m="(";var g="9";var y=")";var b="0";var w="|";var E="=";var S="~";var x="?";var T="+";var N=this.betabreve;var C="1";var k="!";var L="$";var A="4";var O="#";var M="3";var _="{";var D="[";var P="}";var H="]";var B="@";var j=new Array(this.trema,this.spasper,this.spasper2,this.splenis,this.splenis2,this.akut,this.akut2,this.gravis,this.zirkumflex,this.macron,this.breve,this.iotasubscriptum,this.betabreve);for(var F=0;F<e.length;F++){var I=e.charAt(F);if(u[I.toLowerCase()]){if(c[0].length===0){if(I===I.toLowerCase()){if(I=="s"){var q=e.charAt(F+1);if(q=="1"){c[0]="σ";F++;i=false;continue}if(q=="2"){c[0]="ς";F++;i=false;continue}if(q=="3"){c[0]="ϲ";F++;i=false;continue}if(/[\s,\.\-;:\']/.test(q)){c[0]="ς";i=false;continue}}c[0]=u[I]}else{if(I=="S"){var q=e.charAt(F+1);if(q=="1"){c[0]="σ";F++;i=false;continue}if(q=="2"){c[0]="ς";F++;i=false;continue}if(q=="3"){c[0]="ϲ";F++;i=false;continue}}c[0]=u[I.toLowerCase()].toUpperCase()}}else{c=a(c,j,t);l=l+c[0];if(I===I.toLowerCase()){if(I=="s"){var q=e.charAt(F+1);if(q=="1"){c[0]=u[I];F++;i=false;continue}if(q=="2"){c[0]="ς";F++;i=false;continue}if(q=="3"){c[0]="ϲ";F++;i=false;continue}if(/[\s,\.\-;:\']/.test(q)){c[0]="ς";i=false;continue}}c[0]=u[I]}else{if(I=="S"){var q=e.charAt(F+1);if(q=="1"){c[0]="σ";F++;i=false;continue}if(q=="2"){c[0]="ς";F++;i=false;continue}if(q=="3"){c[0]="ϲ";F++;i=false;continue}}c[0]=u[I.toLowerCase()].toUpperCase()}}i=false;continue}if(I==h||I==p){c[5]=true;i=false;continue}if(I==d||I==v){c[6]=true;i=false;continue}if(I==m||I==g){c[3]=true;i=false;continue}if(I==y||I==b){c[4]=true;i=false;continue}if(I==w){c[10]=true;i=false;continue}if(I==E||I==S||I==x){c[7]=true;i=false;continue}if(I==T){c[2]=true;i=false;continue}if(I==N){c[9]=true;i=false;continue}if(I==C||I==k){c[4]=true;c[5]=true;i=false;continue}if(I==L||I==A){c[3]=true;c[6]=true;i=false;continue}if(I==O||I==M){c[3]=true;c[5]=true;i=false;continue}if(I==_||I==D){c[3]=true;c[7]=true;i=false;continue}if(I==P||I==H){c[4]=true;c[7]=true;i=false;continue}if(I==B){c[4]=true;c[6]=true;i=false;continue}if(I=="%"){if(e.charAt(F+1)=="2"){if(e.charAt(F+2)=="6"){c[8]=true;F=F+2}if(e.charAt(F+2)=="7"){c[9]=true;F=F+2}}i=false;continue}c=a(c,j,t);l=l+c[0];c[0]="";if(I==";"||I==":"){l=l+"·";i=false;continue}if(/[\s,\.\-;:\']/.test(I)){l=l+I;i=false;continue}if(s){if(r){if(i){l=l.slice(0,l.lastIndexOf("</fault>",0)-7);l=l+I+"</fault>"}else{l=l+"<fault>"+I+"</fault>";i=true}}else{l=l+I}}f++}if(c[0].length!==0){c=a(c,j,t);l=l+c[0]}l=n(l);var R=new Array(l,f);return R};u.prototype.greekToBetacode=function(e){var t=this.seeDiacritics;this.input=e;var n=this.tagFault;var r=this.seeFault;var i=false;var s=new u;e=s.preprocess(e);var o={"α":"a","β":"b","ϐ":"b","γ":"g","δ":"d","ε":"e","ϵ":"e","ζ":"z","η":"h","ϑ":"q","θ":"q","ι":"i","κ":"k","ϰ":"k","λ":"l","μ":"m","ν":"n","ξ":"c","ο":"o","π":"p","ϱ":"r","ρ":"r","ς":"j","σ":"s","τ":"t","υ":"u","φ":"f","ϕ":"f","χ":"x","ψ":"y","ω":"w","ϝ":"v"};var a=0;var f="";var l="";var c="";var h=false;var p=false;var d=false;var v=false;var m=false;var g=false;var y=false;var b=false;var w=false;var E=false;var S=this.akut;var x=this.gravis;var T=this.spasper;var N=this.splenis;var C=this.iotasubscriptum;var k=this.zirkumflex;var L=this.trema;var A=this.macron;var O=this.breve;var M="/";var _="\\";var D="(";var P=")";var H="|";var B="=";var j="+";var F="&";var I=this.betabreve;if(t==false){M="";_="";D="";P="";H="";B="";j="";F="";I=""}for(var q=0;q<e.length;q++){var R=e.charAt(q);if(o[R.toLowerCase()]){if(c.length===0){if(R===R.toLowerCase()){c=o[R]}else{c="*"+o[(R+"a").toLowerCase().substr(0,1)]}}else{if(h){c="*"+c;h=false}if(b){c=c+j;b=false}if(v){c=c+D;v=false}if(m){c=c+P;m=false}if(p){c=c+M;p=false}if(d){c=c+_;d=false}if(y){c=c+B;y=false}if(w){c=c+F;w=false}if(E){c=c+I;E=false}if(g){c=c+H;g=false}l=l+c;if(R===R.toLowerCase()){c=o[R]}else{c="*"+o[(R+"a").toLowerCase().substr(0,1)]}}i=false;continue}if(R==S){p=true;i=false;continue}if(R==x){d=true;i=false;continue}if(R==T){v=true;i=false;continue}if(R==N){m=true;i=false;continue}if(R==C){g=true;i=false;continue}if(R==k){y=true;i=false;continue}if(R==L){b=true;i=false;continue}if(R==A){w=true;i=false;continue}if(R==O){E=true;i=false;continue}if(b){c=c+j;b=false}if(v){c=c+D;v=false}if(m){c=c+P;m=false}if(p){c=c+M;p=false}if(d){c=c+_;d=false}if(y){c=c+B;y=false}if(w){c=c+F;w=false}if(E){c=c+I;E=false}if(g){c=c+H;g=false}l=l+c;c="";if(R=="·"){l=l+";";i=false;continue}if(R==";"){l=l+"?";i=false;continue}if(R=="ʹ"){l=l+"#";i=false;continue}if(/[\s,\.\-\?;:/']/.test(R)||R==O){l=l+R;i=false;continue}if(r){if(n){if(i){l=l.slice(0,l.lastIndexOf("</fault>",0)-7);l=l+R+"</fault>"}else{l=l+"<fault>"+R+"</fault>";i=true}}else{l=l+R}}a++}if(c.length!==0){if(b){c=c+j}if(v){c=c+D}if(m){c=c+P}if(p){c=c+M}if(d){c=c+_}if(y){c=c+B}if(w){c=c+F}if(E){c=c+I}if(g){c=c+H}l=l+c}var U=new Array(l,a);return U};u.prototype.spionicToBetacode=function(e){var t=new u;t.seeDiacritics=this.seeDiacritics;t.tagFault=this.tagFault;t.seeFault=this.seeFault;t.betabreve=this.betabreve;t.betamacron=this.betamacron;t.akut=this.akut;t.akut2=this.akut2;t.gravis=this.gravis;t.splenis=this.splenis;t.splenis2=this.splenis2;t.spasper=this.spasper;t.spasper2=this.spasper2;t.iotasubscriptum=this.iotasubscriptum;t.zirkumflex=this.zirkumflex;t.trema=this.trema;t.macron=this.macron;t.breve=this.breve;var n=t.spionicToGreek(e)[0];return t.greekToBetacode(n)}})(this)